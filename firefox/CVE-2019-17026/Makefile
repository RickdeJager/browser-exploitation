BIN = ./artifacts/js-debug
REF = ./artifacts/js

.PHONY: interactive
interactive: bundle.js
	@echo "Running exploit in interactive mode..."
	@$(BIN) -i bundle.js

.PHONY: debug
debug: bundle.js
	@echo "Running exploit in debug mode..."
	gdb --args $(BIN) -i bundle.js

.PHONY: run
run: bundle.js
	@echo "Running exploit..."
	@$(BIN) bundle.js

.PHONY: release
release: bundle.js
	@echo "Running exploit in release mode..."
	@$(REF) bundle.js

bundle.js: exploit.js ../../tools/util.js
	python3 ../../tools/generate_bundle.py bundle.js ../../tools/util.js exploit.js
	
clean:
	@rm -f bundle.js
